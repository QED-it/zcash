#include <gtest/gtest.h>

#include "Asset.h"

TEST(AssetTests, AssetDerivationTest) {

    unsigned char ik[Asset::TEMP_IK_SIZE] = {
            0xe1, 0xaf, 0x66, 0x15, 0x70, 0xbe, 0x8c, 0x15,
            0xae, 0x6f, 0x60, 0x70, 0x86, 0x69, 0x42, 0x16,
            0x19, 0xd4, 0x64, 0x82, 0xb7, 0xbf, 0x51, 0x9f,
            0x13, 0xf8, 0xac, 0x2c, 0x7f, 0xc8, 0xaa, 0x1d
    };
    unsigned char *description = (unsigned char *)"Test asset description";

    auto asset = Asset(ik, description);

    unsigned char expected[Asset::ZC_ORCHARD_ZSA_ASSET_ID_SIZE] = {
            0x61, 0xe9, 0x3b, 0xe0, 0x9e, 0x90, 0x7d, 0x5f,
            0x22, 0x4d, 0x08, 0x5b, 0xb5, 0x93, 0x0b, 0xc2,
            0x52, 0x36, 0x27, 0xad, 0xfe, 0xcd, 0x15, 0x11,
            0x4a, 0x0a, 0x48, 0x50, 0x70, 0x94, 0xe5, 0x8d
    };

    for (int i = 0; i < Asset::ZC_ORCHARD_ZSA_ASSET_ID_SIZE; i++) {
        EXPECT_EQ(asset.id[i], expected[i]);
    }
}
